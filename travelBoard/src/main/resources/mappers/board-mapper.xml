<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="edu.kh.travel.board.model.mapper.BoardMapper">
	<!-- 게시판 종류 목록 조회 (+ 표기법 변경) (이건 헤더에 대륙별 이름 보이는 데 사용할 용도) -->
	<select id="selectBoardTypeList">
		SELECT CONTI_CODE "contiCode", 
		CONTI_NAME "contiName" 
		FROM "CONTINENT"
		ORDER BY CONTI_NAME
	</select>

	<!-- 해당 대륙 게시판으로 이동 -->
	<select id="boardList">
	
SELECT BOARD_NO, BOARD_TITLE, MEMBER_NICKNAME, READ_COUNT,
	(SELECT COUNT(*) FROM "COMMENT" C
	WHERE C.BOARD_NO = B.BOARD_NO) COMMENT_COUNT,
	(SELECT COUNT(*)
	FROM "LIKE" L
	WHERE L.BOARD_NO = B.BOARD_NO) LIKE_COUNT,
	<![CDATA[ 
		CASE 
			WHEN SYSDATE-WRITE_DATE < 1/24/60
			THEN FLOOR((SYSDATE-WRITE_DATE)*24*60*60)||'초 전'
			
			WHEN SYSDATE-WRITE_DATE <1/24
			THEN FLOOR((SYSDATE-WRITE_DATE)*24*60)||'분 전'
			
			WHEN SYSDATE-WRITE_DATE <1
			THEN FLOOR((SYSDATE-WRITE_DATE)*24)||'시간 전'
			--더 오래 지나면 ELSE로 날짜로 나온다
			ELSE TO_CHAR(WRITE_DATE, 'YYYY-MM-DD')
		END WRITE_DATE 
	]]>
	FROM "BOARD" B
	JOIN "MEMBER" USING (MEMBER_NO)
	WHERE BOARD_DEL_FL = 'N'
	AND 
	ORDER BY BOARD_NO DESC
	</select>
</mapper>
